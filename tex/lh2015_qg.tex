\documentclass[11pt,letterpaper]{article}
\pdfoutput=1
\usepackage{jheppub}
\usepackage{color}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage{xspace}

\usepackage{verbatim}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[caption=false]{subfig}
\usepackage{url}
\usepackage{bbold}
\usepackage{slashed}
\usepackage{array}

\usepackage{multirow}
\usepackage{threeparttable}
\usepackage{paralist}


\newcommand{\GeV}{\text{GeV}}
\newcommand{\TeV}{\text{TeV}}
\newcommand{\SO}{\text{SO}}
\newcommand{\SU}{\text{SU}}
\newcommand{\SM}{\text{SM}}

\newcommand{\U}{\text{U}}
\newcommand{\CKM}{\text{CKM}}
\newcommand{\eff}{\text{eff}}

\newcommand{\genang}[2]{{\lambda^{#1}_{#2}}}


\newcommand{\ev}{\text{event}}
\newcommand{\jet}{\text{jet}}
\newcommand{\jets}{\text{jets}}
\newcommand{\subj}{\text{subjet}}
\newcommand{\subjs}{\text{subjets}}
\newcommand{\cut}{\text{cut}}
\newcommand{\trim}{\text{trim}}
\newcommand{\Ecut}{E_{{\rm cut}}}

\newcommand{\ptc}{p_{T{\rm cut}}}
\newcommand{\ptsubc}{p_{T{\rm subcut}}}

\newcommand{\sub}{\text{sub}}
\newcommand{\miss}{\text{miss}}

\newcommand{\pythia}{\textsc{Pythia~8}\xspace}
\newcommand{\herwig}{\textsc{Herwig++}\xspace}
\newcommand{\eventtwo}{\textsc{Event2}\xspace}
\newcommand{\vincia}{\textsc{Vincia}\xspace}
\newcommand{\sherpa}{\textsc{Sherpa}\xspace}

\newcommand{\FastJet}{\textsc{FastJet}\xspace}
\newcommand{\MadGraph}{\textsc{MadGraph}\xspace}

\newcommand{\df}{\text{d}}
\newcommand{\vev}[1]{\langle #1 \rangle}


\DeclareRobustCommand{\Sec}[1]{Sec.~\ref{#1}}
\DeclareRobustCommand{\Secs}[2]{Secs.~\ref{#1} and \ref{#2}}
\DeclareRobustCommand{\Secss}[3]{Secs.~\ref{#1}, \ref{#2}, and \ref{#3}}
\DeclareRobustCommand{\App}[1]{App.~\ref{#1}}
\DeclareRobustCommand{\Tab}[1]{Table~\ref{#1}}
\DeclareRobustCommand{\Tabs}[2]{Tables~\ref{#1} and \ref{#2}}
\DeclareRobustCommand{\Fig}[1]{Fig.~\ref{#1}}
\DeclareRobustCommand{\Figs}[2]{Figs.~\ref{#1} and \ref{#2}}
\DeclareRobustCommand{\Figss}[3]{Figs.~\ref{#1}, \ref{#2}, and \ref{#3}}
\DeclareRobustCommand{\Eq}[1]{Eq.~(\ref{#1})}
\DeclareRobustCommand{\Eqs}[2]{Eqs.~(\ref{#1}) and (\ref{#2})}
\DeclareRobustCommand{\Eqss}[3]{Eqs.~(\ref{#1}), (\ref{#2}), and (\ref{#3})}
\DeclareRobustCommand{\Ref}[1]{Ref.~\cite{#1}}
\DeclareRobustCommand{\Refs}[1]{Refs.~\cite{#1}}

\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\nn}{\nonumber}

\renewcommand{\textfraction}{0.10}
\renewcommand{\topfraction}{0.90}
\renewcommand{\bottomfraction}{0.90}
\renewcommand{\floatpagefraction}{0.65}

%% Reference commands %%
\newcommand{\mb}[1]{\boldsymbol{#1}}
\newcommand{\bm}[1]{\boldsymbol{#1}}
\newcommand{\mbo}[1]{\boldsymbol{\overline{#1}}}

\usepackage{xspace}


\def\Tr{\mathop{\rm Tr}}
\newcommand{\rep}[1]{\mathbf{#1}}
\newcommand{\conjrep}[1]{\overline{\mathbf{#1}}}


\renewcommand{\a}{\alpha}
\renewcommand{\b}{\beta}
\newcommand{\e}{\epsilon}
\newcommand{\D}{\Delta}
\renewcommand{\l}{\lambda}
\renewcommand{\th}{\theta}
\newcommand{\bq}{\bar{q}}
\newcommand{\zcut}{z_{\rm cut}}

\newcommand{\IZ}{\mathbb{Z}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\cR}{\mathcal{R}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cI}{\mathcal{I}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\beq}{\begin{eqnarray}}
\newcommand{\eeq}{\end{eqnarray}}

\newcommand{\F}{\mathcal{F}}
\newcommand{\Ft}{\widetilde{\mathcal{F}}}
\newcommand{\G}{\mathcal{G}}
\newcommand{\Gt}{\widetilde{\mathcal{G}}}
\newcommand{\HH}{\mathcal{H}}
\newcommand{\HHt}{\widetilde{\mathcal{H}}}
\newcommand{\ord}[1]{\mathcal{O}\!\left(#1\right)}

\newcommand*\numcircledmod[1]{#1 \!\!\! \bigcirc}

\newcommand{\Njet}{\widetilde{N}_{\rm jet}}
\newcommand{\dN}[1]{\Delta_{#1}}
\newcommand{\dNpm}{\Delta_{2\pm}}
\newcommand{\dNp}{\Delta_{2+}}
\newcommand{\dNm}{\Delta_{2-}}
\newcommand{\dNtm}{\Delta_{3-}}

\newcommand{\cT}{\mathcal{T}}
\newcommand{\as}{\alpha_s}
\renewcommand{\angle}{\theta}

\definecolor{darkgreen}{rgb}{0,0.5,0}
\newcommand{\jdt}[1]{\textbf{\textcolor{darkgreen}{(#1 --jdt)}}}


\begin{document}


\title{Systematics of Quark/Gluon Tagging}

\author{Samuel Bein,}
\emailAdd{samuel.bein@gmail.com}
\author{Andy Buckley,}
\emailAdd{andy.buckley@cern.ch}
\author{Mario Campanelli,}
\emailAdd{mario.campanelli@cern.ch}
\author{Marat Freytsis,}
\emailAdd{freytsis@physics.harvard.edu}
\author{Philippe Gras,}
\emailAdd{philippe.gras@cern.ch}
\author{\\Deepak Kar,}
\emailAdd{deepak.kar@cern.ch}
\author{Andrew Larkoski,}
\emailAdd{larkoski@mit.edu}
\author{Simon Pl\"atzer,}
\emailAdd{simon.plaetzer@desy.de}
\author{Chris Pollard,}
\emailAdd{cspollard@gmail.com}
\author{Salvatore Rappoccio,}
\emailAdd{rappoccio@gmail.com}
\author{Andrzej Siodmok,}
\emailAdd{andrzej@cern.ch}
\author{Peter Skands,}
\emailAdd{peter.skands@monash.edu}
\author{Dave Soper,}
\emailAdd{soper@uoregon.edu}
\author{Gregory Soyez,}
\emailAdd{soyez@lpthe.jussieu.fr}
\author{Frank Tackmann,}
\emailAdd{frank.tackmann@desy.de}
\author[a]{\\Jesse Thaler,}
\affiliation[a]{Center for Theoretical Physics, Massachusetts Institute of Technology, \\ Cambridge, MA 02139, U.S.A.}
\emailAdd{jthaler@mit.edu}
\author{Wouter Waalewijn}
\emailAdd{wouterw@nikhef.nl}


%\date{\today}

\abstract{\jdt{Author list is going to contract.  This abstract is aspirational at the moment.}  By measuring the substructure of a jet, one can assign it a ``quark'' or ``gluon'' tag.  In the eikonal limit, quark/gluon discrimination is determined solely by the color factor of the initiating parton ($C_F$ versus $C_A$).  The goal of this paper is to go beyond this leading-order understanding, using both parton shower generators and first-principles calculations to assess the impact of higher-order perturbative and non-perturbative physics.  In the idealized context of electron-positron collisions, where there exists an unambiguous definition of quark and gluon jets, we find a fascinating interplay between perturbative shower effects and non-perturbative hadronization effects.  Turning to proton-proton collisions, we highlight a core set of measurements which would constrain current uncertainties in quark/gluon tagging and improve the overall modeling of jets at the Large Hadron Collider.}

\preprint{MIT--CTP xxxx}

\maketitle

%-----------------------------------------------------------
\section{Introduction}
\label{introduction}

Jets are a robust tool for studying short-distance collisions involving quarks and gluons.  With a suitable jet definition, one can connect jet measurements made on clusters of hadrons to perturbative calculations made on clusters of partons \cite{}.  More ambitiously, one can try to tag jets with a suitably-defined flavor label, thereby enhancing the fraction of, say, quark-tagged jets over gluon-tagged jets.  This is relevant for searches for physics beyond the standard model, where signals of interest are often dominated by quarks while the corresponding backgrounds are dominated by gluons.  A wide variety of quark/gluon discriminants have been proposed \cite{}, and there is a growing catalog of quark/gluon studies at the Large Hadron Collider (LHC) \cite{}.

In order to achieve robust quark/gluon tagging, though, one needs theoretical and experimental control over quark/gluon radiation patterns.  At the level of eikonal partons, a quark radiates proportional to its $C_F = 4/3$ color factor while a gluon radiates proportional to $C_A = 3$.  In this paper, we demonstrate that quark/gluon discrimination performance is highly sensitive to subleading perturbative effects beyond the eikonal limit, such as $g \to q \overline{q}$ splittings and color coherence, as well as to non-perturbative effects such as color reconnection and hadronization.   While these effects are modeled (to differing degrees) in parton shower generators, they are relatively unconstrained by existing collider measurements, especially in the gluon channel.  The goal of this paper is to highlight these uncertainties and suggest a set of future LHC measurements that will improve the modeling of jets in general and quark/gluon tagging in particular.

A common misconception about quark/gluon tagging is that it is an intrinsically ill-defined problem.  Of course, quark and gluon partons carry color while jets are composed of color-singlet hadrons, so the labels ``quark'' and ``gluon'' are fundamentally ambiguous.  But this is philosophically no different from the fact that a ``jet'' is fundamentally ambiguous and one must therefore always specify a concrete jet finding procedure.  As discussed in \Sec{sec:quarkgluondef}, the proper way to think about quark/gluon discrimination is in the context of unambiguous hadron-level measurements.  In that sense, quark/gluon tagging is a well-defined technique for enhancing desired signals over undesired backgrounds.

There are a wide range of possible quark/gluon discriminants and a similarly large range of ways to quantify discrimination power, both discussed further in  \Sec{sec:prelim}.  As a concrete set of discriminants, we consider the generalized angularities $\lambda_\beta^\kappa$ \cite{} at five different $(\kappa, \beta)$ working points.  These roughly map onto five variables in common use in the literature:
\be
\text{multiplicity}, \quad p_T^D, \quad \text{LHA}, \quad \text{width}, \quad \text{mass},
\ee
where LHA refers to the ``Les Houches Angularity'', named after the workshop where this study was initiated.  To quantify discrimination performance, we focus on classifier separation \cite{}:
\be
\Delta =  \frac{1}{2} \int \df \lambda \, \frac{\bigl(p_q(\lambda) - p_g(\lambda)\bigr)^2}{p_q(\lambda) + p_g(\lambda)},
\ee
where $p_q$ ($p_g$) is the probability distribution for a quark-tagged (gluon-tagged) sample.   To compare to previous studies, we also show some results in terms of more familiar ROC curves.

To avoid some of the complications in properly defining quark and gluon samples, we start our study in \Sec{sec:ee} by comparing the jets produced in the following processes:
\begin{align}
\text{``quark jets''}: \quad & e^+e^- \to (\gamma/Z)^* \to u \overline{u}, \\
\text{``gluon jets''}: \quad & e^+e^- \to h^* \to g g.
\end{align}
These processes are physically distinguishable by the quantum numbers of the associated color singlet production operator, giving a way to label quarks and gluons without reference to the final state.  We compare four different parton shower generators, not only at their default configurations but also with physically-motivated changes:
\begin{itemize}
\item \textsc{Pythia 8.205} \cite{}
\item \textsc{Vincia 1.201} \cite{}
\item \textsc{Herwig++ 2.7.1} \cite{}
\item \textsc{Sherpa 2.1.1} \cite{}
\item \jdt{Is Deductor going to be on this list?}
\end{itemize}
As we will see, the dominant differences between programs arise from physics at the interface between perturbative showering and non-perturbative fragmentation.  We also verify some of the observed behavior in the generators with analytic resummed calculations.

Turning to the LHC in \Sec{sec:pp}, the distinction between quark jets and gluon jets becomes more subtle, since radiation patterns depend on color connections between the measured final state jets and the unmeasured initial state partons.  In order to restrict ourselves to hadron-level measurements, we consider quark/gluon enriched samples:
\begin{align}
\text{``quark enriched''}: \quad & pp \to W/Z/\gamma + \text{jet}, \\
\text{``gluon enriched''}: \quad & pp \to \text{dijets},
\end{align}
where ``enriched'' means that the Born-level process contributing to these channels is dominated by the corresponding jet flavor.  For completeness, we also study the gluon-enriched process $pp \to H + \rm{jet}$; even though this process has a relatively small cross section at the LHC, it is a useful benchmark for our Monte Carlo comparisons.  By making judicious kinematic cuts, we could further flavor-enrich these samples \cite{}, though we will not pursue that in this paper for simplicity.

We present our conclusion and recommendations in \Sec{sec:conclude}.

\section{What is a Quark/Gluon Jet?}
\label{sec:quarkgluondef}

As part of the 2015 Les Houches workshop on ``Physics at TeV Colliders'', an attempt was made to define exactly what is meant by a ``quark jet'' or ``gluon jet''.  Here are some suggested options for defining a quark jet, in order from most ill-defined to most well-defined.

~\\
\noindent \textbf{A quark jet is...}
\begin{itemize}
\item \textbf{A quark parton.}  This definition (incorrectly) assumes that there is a one-to-one map between a jet and its initiating parton.  Because it neglects the important role of additional radiation in determining the structure of a jet, we immediately dismiss this definition.
\item \textbf{A Born-level quark parton.}  This definition at least acknowledges the importance of radiative corrections to jet production, but leaves open the question of how exactly to define the underlying Born-level process from an observed final state.  For one answer, see flavored jet algorithms below.
\item \textbf{The initiating quark parton in a final state parton shower.}  We suspect that this is the definition most LHC experimentalists have in mind.  This is sometime referred to as the ``max-$p_T$'' prescription \cite{}, though it assumes that the parton shower history is meaningful, which may not be the case beyond the strongly-ordered or leading-logarithmic approximations.  Because the parton shower is semi-classical, this definition neglects the impact of genuinely quantum radiative corrections as well as non-perturbative hadronization. 
\item \textbf{An eikonal line with baryon number 1/3 and carrying triplet color charge.}  This is another semi-classical definition that attempts to use a well-defined limit of QCD to define a quark in terms of light-like Wilson lines.  Philosophically, this is similar to the parton shower picture, with a similar concern about how to extrapolate this definition away from the strict eikonal limit.
\item \textbf{A parton-level jet object that has been quark-tagged using an infrared and collinear (IRC) safe flavored jet algorithm.}  This is the strategy adopted in \cite{} (see also \cite{}).  While this definition neglects the impact of hadronization, it does allow for the calculation of quark jet cross sections at all perturbative orders, including quantum corrections.
\end{itemize}
The unifying theme in the above definitions is that they are trying to identify a quark as an object unto itself, without reference to the specific final state of interest.  However, it is well-known that a ``quark'' in one process may not look like a ``quark'' in other process, due to color correlations with the rest of the event, especially the initial state in $pp$ collisions.  The next definition attempts to deal with the process dependence in defining quarks. 
\begin{itemize}
\item \textbf{A quark operator appearing in a hard matrix element in the context of a factorization theorem.}  This is similar to the attitude taken in \cite{}.  In the context of a well-defined cross section measurement, one can (sometimes) go to a limit of phase space where the hard production of short-distance quarks and gluons factorizes from the subsequent long-distance fragmentation.  This gives quarks a nice (gauge-covariant) operator definition of a quark jet.  That said, even if a factorization theorem does exist for the measurement of interest, this definition is potentially ambiguous beyond leading power.
\end{itemize}
The definition we adopt in this paper is inspired by the idea that one should always think about quark tagging in the context of a specific measurement, but it tries to avoid relying on the presence of a factorization theorem.
\begin{itemize}
\item \textbf{A phase space region (as defined by an unambiguous hadronic fiducial cross section measurement) that yields an enriched sample of quarks (as interpreted by some suitable, though fundamentally ambiguous, criterion).}  Here, the goal is to \emph{tag} a phase space region as being quark-like, rather than try to determine a truth definition of a quark.  This definition has the advantage of being explicitly tied to hadronic final states and to the discriminant variables of interest.   Of course, the main challenge with this definition is how to determine the criterion that corresponds to successful quark-enrichment.  For that, we will have to rely to some degree on the other less well-defined notions of what a quark jet is.
\end{itemize}  

It is worth emphasizing that this last definition separates the measurement process from the interpretation process.  That is, one first measures hadron-level discriminant variables on a final state of interest, and only later does one interpret exactly what that discrimination accomplishes (either as quark/gluon separation or as some more sophisticated classification).  Ultimately, we will be recommending that the LHC experiments perform measurements of the generalized angularities $\lambda_\beta^\kappa$ in well-defined hadron-level final states.  It is then a separate interpretation step to infer something about parton-level quark/gluon radiation patterns from these hadron-level measurements.

\section{Preliminaries}
\label{sec:prelim}

\subsection{Generalized Angularities}

\begin{figure}
\centering
\subfloat{
\includegraphics[scale = 0.7]{figures/lambda_space.pdf}
}
\caption{Two parameter family of generalized angularities, adapted from \cite{Larkoski:2014pca}.  The dots correspond to the five benchmark angularities used in our study.}
\label{fig:lambda_space}
\end{figure}

A wide variety of quark/gluon discriminants have been proposed (see \cite{} for a catalog), but here we limit ourselves to a two-parameter family of generalized angularities \cite{}, shown in \Fig{fig:lambda_space}.  These are defined as
\begin{equation}
\label{eq:genang}
\genang{\kappa}{\beta} = \sum_{i \in \text{jet}} z_i^\kappa \theta_i^\beta,
\end{equation}
where $i$ runs over the jet constituents, $z_i \in [0,1]$ is a momentum fraction, and $\theta_i \in [0,1]$ is a (normalized) recoil-free angle. The parameters $\kappa \ge 0$ and $\beta \ge 0$ determine the momentum and angle weighting, respectively.  For $\kappa = 1$, the generalized angularities are IRC safe, though there are techniques to treat the $\kappa \not= 1$ case using generalized fragmentation functions \cite{Larkoski:2014pca}.  In our Monte Carlo studies, we determine $\genang{\kappa}{\beta}$ using all constituents of a jet, though one could also consider using charged-particle-only angularities to improve robustness to pileup.

For our $e^+ e^-$ study, we cluster jets using the $ee$-variant of the anti-$k_t$ algorithm \cite{}, with $|\vec{p}|$-ordered winner-take-all recombination \cite{} to determine the jet axis $\hat{n}$.  Note that unlike in standard $E$-scheme recombination, the jet axis $\hat{n}$ is not necessarily aligned with the jet momentum $\vec{p}$, which turns out to be a desirable feature for avoiding soft recoil effects \cite{}.  We then define
\be
z_i \equiv \frac{E_i}{E_{\rm jet}}, \qquad \theta_i \equiv \frac{\Omega_{i \hat{n}}}{R},
\ee
where $\Omega_{i \hat{n}}$ is the opening angle to the jet axis and $R$ is the jet radius (taken to be $R = 0.6$ by default).  For our $pp$ study, we use the standard $pp$ version of anti-$k_t$, with $p_T$-ordered winner-take-all recombination, defining
\be
z_i \equiv \frac{p_{Ti}}{\sum_{j \in \text{jet}} p_{Tj}}, \qquad \theta_i \equiv \frac{R_{i \hat{n}}}{R},
\ee
where $R_{i \hat{n}}$ is the rapidity-azimuth distance to the jet axis.

By adjusting $\kappa$ and $\beta$, one can probe different aspects of the jet fragmentation.  We consider five benchmark values for $(\kappa, \beta)$ indicated by dots in \Fig{fig:lambda_space}:
\be
\label{eq:benchmarkang}
\begin{aligned}
(0,0) &= \text{particle multiplicity},\\
(2,0) &\Rightarrow p_T^D \text{  \cite{} (specifically $\genang{2}{0} = (p_T^D)^2$)},\\
(1,0.5) & = \text{Les Houches Angularity (LHA)},\\
(1,1) &= \text{width or broadening \cite{}} ,\\
(1,2) & \Rightarrow \text{mass or thrust \cite{} (specifically $\genang{1}{2} \simeq m_{\rm jet}^2 / p_{T{\rm jet}}$)}.
\end{aligned}
\ee
Except for the LHA, these angularities (or their close cousins) have already been used in quark/gluon discrimination studies.  The LHA has been included to have an IRC safe angularity that weights energies more heavily than angles, similar in spirit to the $\beta = 0.2$ value advocated in \Ref{}.

For the IRC safe case of $\kappa = 1$, there is an alternative version of the angularities based on energy correlation functions \jdt{not sure about my definition here, especially factors of 2.}
\be
\text{ecf}_\beta = \frac{1}{2}\sum_{i \not= j \in \text{jet}} z_i z_j \theta_{ij}^\beta \simeq \genang{1}{\beta},
\ee
where equality holds in the extreme eikonal limit.\footnote{This equality also relies on using a recoil-free axis choice $\hat{n}$ to define $\theta_i$.}  Amusingly, $\lim_{\beta \to 0} \text{ecf}_\beta = 1 - 2 \genang{2}{0}$ \cite{} (i.e.~$\kappa = 2$, $\beta = 0$).  To avoid a proliferation of curves, we will not show any results for $\text{ecf}_\beta$.  We will also neglect quark/gluon discriminants that take into account azimuthal asymmetries within the jet, such as elliptically \cite{} and 2-subjettiness \cite{}, though azimuthal information can improve quark/gluon discrimination \cite{}.

\subsection{Metrics for Discrimination Power}

Since we will be testing many Monte Carlo variants, we need a way to quantify quark/gluon separation power in a robust way that can easily be summarized by a single number.  For that purpose we use classifier separation \cite{}:
\be
\Delta =  \frac{1}{2} \int \df \lambda \, \frac{\bigl(p_q(\lambda) - p_g(\lambda)\bigr)^2}{p_q(\lambda) + p_g(\lambda)},
\ee
where $p_q$ ($p_g$) is the probability distribution for the quark-tagged (gluon-tagged) sample.  Here, $\Delta = 0$ corresponds to no discrimination power and $\Delta = 1$ corresponds to perfect discrimination power.  Because $\Delta$ is defined as an integral, one can use standard error propagation to assign statistical uncertainties on the Monte Carlo results.

To gain more intuition about quark/gluon performance, we will also show some results in terms of ROC curves.  At a point ($q$,$g$) on the ROC curve, where $q,g \in [0,1]$, one can define a selection that yields $q$ efficiency for quarks and $g$ mistag rate for gluons, or equivalently, a $(1-g)$ efficiency for gluons for a $(1-q)$ mistag rate for quarks.  From the ROC curve, we define two benchmark points, visualized in \Fig{fig:roc_curve}:
\be
\{ g^{\rm  rej}_{50} ,   g^{\rm  rej}_{20}\} : \quad \text{Gluon rejection rate at \{50\%, 20\%\} quark efficiency}. \\
\ee
Here, $g_x^{\rm rej} \in [1- x\%,1]$, where the low end corresponds to no discrimination power and $1$ corresponds to optimal discrimination.

%\begin{align}
%\{ g^{\rm  rej}_{50} ,   g^{\rm  rej}_{20}\} : \quad & \text{Gluon rejection rate at \{50\%, 20\%\} quark efficiency}; \\
%\{q^{\rm rej}_{50} ,  q^{\rm rej}_{20}\} : \quad & \text{Quark rejection rate at \{50\%, 20\%\} gluon efficiency}; \\
%s^{\rm rej} : \quad & \text{Symmetric rejection rate at $s^{\rm rej}$ efficiency}.
%\end{align}
%For all of these measures, $x^{\rm rej} \in [\frac{1}{2},1]$, where $\frac{1}{2}$ corresponds to no discrimination and $1$ corresponds to optimal discrimination.  \jdt{This next sentence is no longer truth, I think.}  To assign statistical errors to these quantities in Monte Carlo, we make the simplifying assumption that the uncertainty is only due to Poisson statistics on the $x^{\rm rej}$ value.

\begin{figure}
\centering
\subfloat[]{
\label{fig:roc_curve}
\includegraphics[scale = 0.8]{figures/roc_curve}
}
$\qquad$
\subfloat[]{
\label{fig:truth_overlap}
\includegraphics[scale = 0.8]{figures/truth_overlap}
}
\caption{(a) Two benchmark points on the ROC Curve.  (b) Relationship between mutual information $I(T;A)$ and classified separation $\Delta$.}
\end{figure}

%The minimum value of $I(T;A)$ is $0$ (no discrimination) and the maximum value is
%\be
%I(T;A)_{\rm max} = f \log_2 \frac{1}{f} + (1-f) \log_2 \frac{1}{1-f},
%\ee
%which equals $1$ for $f = \frac{1}{2}$.  

An alternative way to quantify discrimination power is through mutual information, which counts the number of ``bits'' of information gained from measuring a discriminant variable (see \cite{Larkoski:2014pca}).  Given a sample with quark fraction $f \in [0,1]$ and gluon fraction $(1-f)$, the mutual information with the truth (a.k.a. the truth overlap) is:
\be
I(T;A) = \int \df a \left(f \, p_q(a) \log_2 \frac{p_q(a)}{p_{\rm tot}(a)} + (1-f) \, p_g(a) \log_2 \frac{p_g(a)}{p_{\rm tot}(a)}   \right),
\ee
where
\be
p_{\rm tot}(a) = f \, p_q(a) + (1-f) \, p_g(a).
\ee
The choice $f = 1/2$ was used in \Ref{Larkoski:2014pca},
\be
I(T;A)\big|_{f = \frac{1}{2}} \equiv I_{\frac{1}{2}},
\ee though other $f$ choices are plausible.  Though we will not use mutual information in our studies, it is amusing to note that the second derivative of $I(T;A)$ with respect to $f$ is directly related to classifier separation:
\be
\label{eq:altdeltadef}
- \frac{\log 2}{4} \frac{\partial^2 I(T;A)}{\partial f^2} \Big|_{f = \frac{1}{2}} \equiv I''_\frac{1}{2} \equiv \Delta.
\ee
More generally, the dependence of $I(T;A)$ on $f$ can be related to other concepts in statistics, as visualized in \Fig{fig:truth_overlap}.  At $f = 0$ and $f = 1$, the mutual information itself is zero, but the derivatives are:
\begin{align}
\frac{\partial I}{\partial f} \Big|_{f = 0} &\equiv I'_0 = \int \df a \, p_q(a)  \log_2 \frac{p_q(a)}{p_g(a)}, \quad &- \log 2 \,  \frac{\partial^2 I}{\partial f^2} \Big|_{f = 0} &\equiv I''_0 = \int \df a \,  \frac{p_q(a)^2}{p_g(a)},\\
- \frac{\partial I}{\partial f} \Big|_{f = 1} &\equiv I'_1 = \int \df a \, p_g(a) \log_2 \frac{p_g(a)}{p_q(a)}, \quad &- \log 2 \, \frac{\partial^2 I}{\partial f^2} \Big|_{f = 1} &\equiv I''_1 = \int \df a \, \frac{p_g(a)^2}{p_q(a)}.
\end{align}
The first derivative is sometimes called relative entropy and the second derivative is sometimes called discrimination significance.  

%However, all of these quantities become singular if the probability distribution is zero, so we will only quote the values at $f = \frac{1}{2}$, visualized in \Fig{fig:truth_overlap}:
%\be
%\{I_\frac{1}{2}, I''_{\frac{1}{2}} \}.
%\ee
%To assign statistical errors to these quantities in Monte Carlo, we evaluate $I(T;A)$ in bins of $a$ and use Poisson statistics.  Note that there is a binning bias in $I_\frac{1}{2}$, so we use the method explained in Appendix A.3 of \Ref{Larkoski:2014pca} and use half the $\Delta a$ bin size on the combined quark/gluon sample compared to the individual quark/gluon samples.

\subsection{Baseline Expectation from Casimir Scaling}

At LL accuracy for the IRC safe angularities, the quark/gluon discrimination performance only depends on the color factor ratio $C_A/C_F$.  The reason is that the angularity distributions satisfy a property called Casimir scaling.  Let us first introduce the notation for the cumulative distribution $\Sigma(\lambda)$, which is defined by
\be
\Sigma(\lambda) = \int_0^\lambda \df \lambda' \, p(\lambda'), \qquad p(\lambda) = \frac{\df \Sigma}{\df \lambda}.
\ee
If an observable satisfies Casimir scaling, then the quark and gluon cumulative distributions can be written as
\be
\Sigma_q(\lambda) = e^{-C_F r(\lambda)}, \qquad \Sigma_g(\lambda) = e^{-C_A r(\lambda)},
\ee
where $r(\lambda)$ is monotonically decreasing, and the only difference between quarks and gluons appears in $C_F = 4/3$ versus $C_A = 3$.

Observables that satisfy Casimir scaling have universal ROC curves \cite{} and universal truth overlaps \cite{}, which are independent of the precise functional form of $r(\lambda)$ and only depend on the ratio $C_A/C_F$.  We can derive the same universality for classifier separation, using $p_i(\lambda) = - C_i r'(\lambda) e^{-C_i r(\lambda)}$ and the change of variables $u = e^{-C_F r(\lambda)}$:
\begin{align}
\Delta &=  -\frac{1}{2} \int \df \lambda \, r'(\lambda) \frac{\bigl(C_F e^{-C_F r(\lambda)} - C_A e^{-C_A r(\lambda)}\bigr)^2}{C_F e^{-C_F r(\lambda)}+ C_A e^{-C_A r(\lambda)}} , \\
& = \frac{1}{2} \int_0^1 \frac{\df u}{u} \frac{\bigl(u - (C_A / C_F) u^{C_A/C_F}\bigr)^2}{u + (C_A/C_F) u^{C_A/C_F}} , \\
& = 2 \left({}_2F_1\left[1,\frac{C_F}{C_A - C_F}; \frac{C_A}{C_A - C_F}; - \frac{C_A}{C_F}\right] - \frac{1}{2}  \right),
\end{align}
where ${}_2F_1[a,b;c;z]$ is the hypergeometric function.\footnote{An alternative way to derive this result is taking the result for $I(T;A)$ in \Ref{Larkoski:2014pca} and using \Eq{eq:altdeltadef} to extract $\Delta$.  \jdt{Haven't explicitly checked that last statement yet.}}  For the case of QCD with $C_A/C_F = 9/4$,\footnote{In large $N_c$ QCD where $C_A/C_F \to 2$, $\Delta \to \ln 3 - 1 \simeq 0.0986$.}
\be
\Delta_{\rm QCD} \simeq  0.1286.
\ee
We mark this benchmark value on the subsequent plots for reference.  \jdt{We don't yet, but we should.}  

Going beyond LL accuracy, Casimir scaling is typically violated, and $\Delta$ depends on the precise observable in question.  Thus, all of the differences we see in our subsequent studies are effects that are truly higher-order (or non-perturbative) effects.

\subsection{Parton-level Quark/Gluon Tags}

\jdt{Do we want to say anything here about QCDAware or flavored jet algorithms?  Are we going to use them?  If Andy has a specific use case in mind, we can try, but my intuition is to stick to our fiducial cross section story.}  \jdt{Answer, yes, we want to do this.}

\section{Idealized Quark/Gluon Tagging}
\label{sec:ee}

We begin our quark/gluon studies with the idealized case of discriminating $e^+ e^- \to (\gamma/Z)^* \to u \bar{u}$ (quark-tagged) from $e^+ e^- \to h^* \to gg$ (gluon-tagged).  Here, the flavor of the outgoing jets is fixed by the Lorentz structure of the production vertex.  Of course, even in the quark-tagged sample, there can be ``gluon jets'', as in $e^+ e^- \to u \bar{u} g$ where a hard gluon recoils against a nearly collinear $u \bar{u}$.  This reflects the intrinsic ambiguity in the definition of jet flavor.   To resolve that ambiguity, we rely on the production vertex alone to define the truth-level jet flavor.

\begin{figure}
\centering
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/GA_10_05_R6_hadron_quark.pdf}
\label{fig:LHA_hadron_quark}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/GA_10_05_R6_hadron_gluon.pdf}
\label{fig:LHA_hadron_gluon}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/GA_10_05_R6_hadron_separation.pdf}
\label{fig:LHA_hadron_separation}
}
\caption{Distributions of the LHA for (a) the $e^+ e^- \to u \bar{u}$ quark-tagged sample, (b) the $e^+ e^- \to gg$ gluon-tagged sample, and (c) the classifier separation integrand in \Eq{eq:deltaintegrand}.  All four parton shower generators are run at their baseline settings.  \jdt{Is there a way to make the font size bigger in the yoda plots?}}
\label{fig:LHA_hadron}
\end{figure}


In \Fig{fig:LHA_hadron} we show distributions of the LHA in the quark sample ($p_q$) and gluon sample ($p_g$), comparing the baseline settings of four different parton shower generators at a center-of-mass collision energy of $Q = 200~\GeV$. In the quark sample, there is relatively little variation between the generators, which is not surprising since all four programs have been tuned to match LEP data (though LEP never measured the LHA itself).  There are somewhat larger variations between the generators in the gluon sample, since there is no data to directly constrain $e^+ e^- \to gg$.

In \Fig{fig:LHA_hadron_separation}, we plot the integrand of classifier separation:
\be
\label{eq:deltaintegrand}
\frac{1}{2} \frac{\bigl(p_q - p_g\bigr)^2}{p_q + p_g}.
\ee
This quantity shows where in the LHA phase space the actual discrimination power lies, with large values of the integrand corresponding to places where the quark and gluon distributions are most dissimilar.  Now we see considerable differences between the generators, reproducing the well-known fact that \pythia\ is more optimistic about quark/gluon separation while \herwig\ is more pessimistic.

\begin{figure}
\centering
\subfloat{
\includegraphics[width = 0.45\columnwidth]{figures/I2_R6_hadron__all.pdf}
}
\caption{Classifier separation for the five different benchmark angularities, determined from four different parton shower generators.}
\label{fig:summary_hadron_all}
\end{figure}

To summarize the overall discrimination power, we integrate \Eq{eq:deltaintegrand} to obtain the value of $\Delta$ for the LHA.  This is shown in \Fig{fig:summary_hadron_all}, which also includes the four other benchmark angularities from \Eq{eq:benchmarkang}.  There is a rather large spread in predicted discrimination power between the generators.  While such differences might be expected for IRC unsafe angularities which depend on non-perturbative modeling, these differences persist even for the IRC safe angularities, indicating a more fundamental difference between the generators that is already present at parton level.  In the rest of this section, we explore these differences in order to ascertain their origin.

\subsection{Parameter Dependence}
\label{sec:ee_scales}

Given the large absolute differences in discrimination power, we next want to check if the four generators exhibit similar or dissimilar trends as parameters are varied.  We perform three parameter sweeps, using the bolded values below as defaults:
\be
\begin{aligned}
\text{Collision Energy}: Q &= \{ 50, 100, \mathbf{200}, 400, 800\}~\GeV, \\
\text{Jet Radius}: R &= \{ 0.2, 0.4, \mathbf{0.6}, 0.8, 1.0\}, \\
\text{Strong Coupling}: \alpha_s / \alpha_{s0} &= \{0.8,0.9,\mathbf{1.0},1.1,1.2\}, \\
\end{aligned}
\ee
where $\alpha_{s0}$ is the default value of the coupling, which is different between generators (and sometimes different between different aspects of the same generator.

The resulting values of $\Delta$ are shown in \Fig{fig:ee_sweep}, which not only shows hadron-level results, but also parton-level results where the hadronization step in each program has been turned off.  There are number of surprising features in these plots.  First, even for the IRC safe angularities, the effect of hadronization is rather large, both on the absolute scale of discrimination and the trends.  Second, the slope of the trends can flip signs between different generators.  \jdt{More discussion.}

\begin{figure}
\centering
\subfloat[]{
\includegraphics[width = 0.4\columnwidth]{figures/I2_GA_10_05_hadron_Qdep.pdf}
\label{fig:sweep_Q_hadron}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.4\columnwidth]{figures/I2_GA_10_05_parton_Qdep.pdf}
\label{fig:sweep_Q_parton}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.4\columnwidth]{figures/I2_GA_10_05_hadron_Rdep.pdf}
\label{fig:sweep_R_hadron}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.4\columnwidth]{figures/I2_GA_10_05_parton_Rdep.pdf}
\label{fig:sweep_R_parton}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.4\columnwidth]{figures/I2_GA_10_05_hadron_alphadep.pdf}
\label{fig:sweep_as_hadron}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.4\columnwidth]{figures/I2_GA_10_05_parton_alphadep.pdf}
\label{fig:sweep_as_parton}
}
\caption{Sweeping the collision energy $Q$ (top row), jet radius $R$ (middle row), and coupling constant $\alpha_s/\alpha_{s0}$ (bottom row).  Results are shown at hadron level (left column) as well as at parton level (right column).  \jdt{Is this for LHA or some other variable?}}
\label{fig:ee_sweep}
\end{figure}

\subsection{Impact of Generator Settings}

\begin{figure}
\centering
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/I2_R6_hadron_pythia.pdf}
\label{fig:summary_hadron_pythia}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/I2_R6_parton_pythia.pdf}
\label{fig:summary_parton_pythia}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/I2_R6_hadron_vincia.pdf}
\label{fig:summary_hadron_vincia}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/I2_R6_parton_vincia.pdf}
\label{fig:summary_parton_vincia}
}
\caption{Settings variants in \pythia (top row) and \vincia (bottom row).  Shown are hadron-level results (left column) and parton-level results (right column).}
\label{fig:settings_variation_1}
\end{figure}

\begin{figure}
\centering
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/I2_R6_hadron_herwig.pdf}
\label{fig:summary_hadron_herwig}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/I2_R6_parton_herwig.pdf}
\label{fig:summary_parton_herwig}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/I2_R6_hadron_sherpa.pdf}
\label{fig:summary_hadron_sherpa}
}
$\quad$
\subfloat[]{
\includegraphics[width = 0.45\columnwidth]{figures/I2_R6_parton_sherpa.pdf}
\label{fig:summary_parton_sherpa}
}
\caption{Same as \Fig{fig:settings_variation_1}, but for (top row) \herwig and (bottom row) \sherpa.}
\end{figure}

Formally, parton shower generators are only accurate to modified leading logarithmic (MLL) accuracy, though they include physically important effects like energy/momentum conservation and matrix element corrections that go beyond MLL.  We now assess the impact of these higher-order effects by changing the baseline parameter settings in each of the generators.

\jdt{We should split into hadron-level and parton-level settings changes.}


\begin{itemize}
\item \pythia\ : CR1, CR2, a2L, nogqq, nome, norec
\item \vincia\ : a2L, muq, nome, nogqq, norec
\item \herwig\ : dipole, dipoleNoCR, nocr, nogqq
\item \sherpa\ : njeto0, njet1-noqq, njet1
\end{itemize}

\clearpage

\subsection{Predictions from Resummation}

\jdt{Talk to Frank if this is feasible.  At minimum, we can do LL/NLL based on my paper with Andrew and Wouter.}

\section{Quark/Gluon Tagging at the LHC}
\label{sec:pp}

\subsection{Enriched Quark/Gluon Samples}

\begin{figure}
\centering
\subfloat{
\includegraphics[width = 0.45\columnwidth]{figures/parton_level_qg_composition.pdf}
}
\caption{Quark fraction of jets at parton level, as defined by the generator-level parton flavor..}
\label{fig:parton_level_qg_composition}
\end{figure}

Because the definition of a quark/gluon jet is ambiguous, we will aim for quark/gluon-enriched samples, as defined by the flavor label of the jet in the corresponding Born-level partonic process.  As shown in \Fig{fig:parton_level_qg_composition}, the Born-level jet in $W/Z/\gamma + \text{jet}$ is more than 70\% quark enriched over the entire jet $p_T$ range of interest.  For jets softer than around 200 GeV, the Born-level jet in dijets or $H+\text{jet}$ is more than 60\% gluon enriched, with that fraction decreasing as the jet $p_T$ increases.  

\subsection{Tagging Performance}


\section{Conclusions}
\label{sec:conclude}




\begin{acknowledgments}
We thank Jon Butterworth, Peter Loch, Alexander Schmidt, \jdt{and anyone else who wants to take their name off of the paper}.  We thank L'\'{E}cole de Physique des Houches and the organizers of the 2015 Les Houches workshop on ``Physics at TeV Colliders'' for a stimulating environment while this work was being initiated.  J.T. is supported by the U.S. Department of Energy (DOE) under cooperative research agreement DE-SC-00012567, the DOE Early Career research program DE-SC-0006389, and by a Sloan Research Fellowship from the Alfred P. Sloan Foundation.

\end{acknowledgments}


\bibliographystyle{JHEP}
\bibliography{lh2015_qg}

\end{document}
